
util     = @(c)  (c.^(1-param.sigma))./(1-param.sigma);
mutil    = @(c)  (1./(c.^param.sigma));
invutil  = @(u)  (((1-param.sigma).*u).^(1/(1-param.sigma)));
invmutil = @(mu) ((1./mu).^(1/param.sigma));

NN   = grid.nb*grid.na*grid.nse;

VALUE_ind   = 1:NN;
mutil_c_ind = NN + (1:NN);
Va_ind      = 2*NN + (1:NN);

R_cb_ind        = 1;
w_ind           = 2;
A_b_ind         = 3;
B_b_ind         = 4;
A_g_ind         = 5;
Q_ind           = 6;
lev_ind         = 7;
NW_b_ind        = 8;
R_tilde_ind     = 9;
x_cb_ind        = 10;
pastpi_ind      = 11;
pastY_ind       = 12;
pastC_ind       = 13;
pastI_ind       = 14;
pastPROFIT_ind  = 15;
pastunemp_ind   = 16;
pastG_ind       = 17;
pastLT_ind      = 18;
R_star_ind      = 19;
B_F_ind         = 20;
Z_ind           = 21;
PSI_RP_ind      = 22;
eta_ind         = 23;
D_ind           = 24;
GG_ind          = 25;
iota_ind        = 26;
BB_ind          = 27;
PSI_W_ind       = 28;
MP_ind          = 29;
p_mark_ind      = 30;
eps_QE_ind      = 31;
eps_RP_ind      = 32;
eps_B_F_ind     = 33;
eps_BB_ind      = 34;
eps_Z_ind       = 35;
eps_G_ind       = 36;
eps_D_ind       = 37;
eps_R_ind       = 38;
eps_iota_ind    = 39;
eps_eta_ind     = 40;
eps_w_ind       = 41;

idx.R_cb_ind        = R_cb_ind        ;
idx.w_ind           = w_ind           ;
idx.A_b_ind         = A_b_ind         ;
idx.B_b_ind         = B_b_ind         ;
idx.A_g_ind         = A_g_ind         ;
idx.Q_ind           = Q_ind           ;
idx.lev_ind         = lev_ind         ;
idx.NW_b_ind        = NW_b_ind        ;
idx.R_tilde_ind     = R_tilde_ind     ;
idx.x_cb_ind        = x_cb_ind        ;
idx.pastpi_ind      = pastpi_ind      ;
idx.pastY_ind       = pastY_ind       ;
idx.pastC_ind       = pastC_ind       ;
idx.pastI_ind       = pastI_ind       ;
idx.pastPROFIT_ind  = pastPROFIT_ind  ;
idx.pastunemp_ind   = pastunemp_ind   ;
idx.pastG_ind       = pastG_ind       ;
idx.pastLT_ind      = pastLT_ind      ;
idx.R_star_ind      = R_star_ind      ;
idx.B_F_ind         = B_F_ind         ;
idx.Z_ind           = Z_ind           ;
idx.PSI_RP_ind      = PSI_RP_ind      ;
idx.eta_ind         = eta_ind         ;
idx.D_ind           = D_ind           ;
idx.GG_ind          = GG_ind          ;
idx.iota_ind        = iota_ind        ;
idx.BB_ind          = BB_ind          ;
idx.PSI_W_ind       = PSI_W_ind       ;
idx.MP_ind          = MP_ind          ;
idx.p_mark_ind      = p_mark_ind      ;
idx.eps_QE_ind      = eps_QE_ind      ;
idx.eps_B_F_ind     = eps_B_F_ind     ;
idx.eps_RP_ind      = eps_RP_ind      ;
idx.eps_BB_ind      = eps_BB_ind      ;
idx.eps_Z_ind       = eps_Z_ind       ;
idx.eps_G_ind       = eps_G_ind       ;
idx.eps_D_ind       = eps_D_ind       ;
idx.eps_R_ind       = eps_R_ind       ;
idx.eps_iota_ind    = eps_iota_ind    ;
idx.eps_eta_ind     = eps_eta_ind     ;
idx.eps_w_ind       = eps_w_ind       ;


MRS_ind        = 1;
A_hh_ind       = MRS_ind       + 1;
B_hh_ind       = A_hh_ind      + 1;
C_ind          = B_hh_ind      + 1;
N_ind          = C_ind         + 1;
L_ind          = N_ind         + 1;
UB_ind         = L_ind         + 1;
K_ind          = UB_ind        + 1;
B_ind          = K_ind         + 1;
B_gov_ncp_ind  = B_ind         + 1;
T_ind          = B_gov_ncp_ind + 1;
LT_ind 	       = T_ind         + 1;
G_ind          = LT_ind 	   + 1;
Lambda_ind     = G_ind         + 1;
pi_ind         = Lambda_ind    + 1;
V_ind          = pi_ind        + 1;
J_ind          = V_ind + (1:grid.ns)';  
h_ind          = J_ind(end)    + 1;          
v_ind          = h_ind         + 1;
Y_ind          = v_ind         + 1;
Profit_ind     = Y_ind         + 1;
r_k_ind        = Profit_ind    + 1;
r_a_ind        = r_k_ind       + 1;
MC_ind         = r_a_ind       + 1;
unemp_ind      = MC_ind        + 1;
nn_ind         = unemp_ind     + 1;
M_ind          = nn_ind        + 1;
f_ind          = M_ind         + 1;
zz_ind         = f_ind         + 1;
xx_ind         = zz_ind        + 1;
vv_ind         = xx_ind        + 1;
ee_ind         = vv_ind        + 1;
C_b_ind        = ee_ind        + 1;
Profit_FI_ind  = C_b_ind       + 1;
RRa_ind        = Profit_FI_ind + 1;
RR_ind         = RRa_ind       + 1;
I_ind          = RR_ind        + 1;
x_k_ind        = I_ind         + 1;
A_g_obs_ind    = x_k_ind       + 1;
Y_obs_ind      = A_g_obs_ind    + 1; % 6
C_obs_ind      = Y_obs_ind      + 1; % 5
I_obs_ind      = C_obs_ind      + 1; % 4
w_obs_ind      = I_obs_ind      + 1; % 3
PROFIT_obs_ind = w_obs_ind      + 1; % 2
unemp_obs_ind  = PROFIT_obs_ind + 1; % 1
inf_obs_ind    = unemp_obs_ind  + 1;
R_obs_ind      = inf_obs_ind    + 1;
pastw_ind      = R_obs_ind      + 1;
G_obs_ind      = pastw_ind      + 1;

pastYY_ind        = G_obs_ind       + 1;
pastCC_ind        = pastYY_ind      + 1; 
pastII_ind        = pastCC_ind      + 1; 
pastPPROFIT_ind   = pastII_ind      + 1;
pastuu_ind        = pastPPROFIT_ind + 1;
pastGG_ind        = pastuu_ind      + 1;
pastA_g_ind       = pastGG_ind      + 1;

l_lambda_ind      = pastA_g_ind    + 1;
pastQ_ind         = l_lambda_ind   + 1;
x_I_ind           = pastQ_ind      + 1;
eta2_ind          = x_I_ind        + 1;
iota2_ind         = eta2_ind       + 1;
pastLT2_ind       = iota2_ind      + 1;
pastG2_ind        = pastLT2_ind     + 1;
LT_obs_ind        = pastG2_ind      + 1;
B_gov_ncp2_ind    = LT_obs_ind      + 1;

idx.MRS_ind         = MRS_ind;
idx.A_hh_ind        = A_hh_ind;
idx.B_hh_ind        = B_hh_ind;
idx.C_ind           = C_ind;
idx.N_ind           = N_ind;
idx.L_ind           = L_ind;
idx.UB_ind          = UB_ind;
idx.K_ind           = K_ind;
idx.B_ind           = B_ind;
idx.B_gov_ncp_ind   = B_gov_ncp_ind;
idx.T_ind           = T_ind;
idx.LT_ind          = LT_ind;
idx.G_ind           = G_ind;
idx.Lambda_ind      = Lambda_ind;
idx.pi_ind          = pi_ind;
idx.V_ind           = V_ind;
idx.J_ind           = J_ind;
idx.h_ind           = h_ind;
idx.v_ind           = v_ind;
idx.Y_ind           = Y_ind;
idx.Profit_ind      = Profit_ind;
idx.r_k_ind         = r_k_ind;
idx.r_a_ind         = r_a_ind;
idx.MC_ind          = MC_ind;
idx.unemp_ind       = unemp_ind;
idx.nn_ind          = nn_ind;
idx.M_ind           = M_ind;
idx.f_ind           = f_ind;
idx.zz_ind          = zz_ind;
idx.xx_ind          = xx_ind;
idx.vv_ind          = vv_ind;
idx.ee_ind          = ee_ind;
idx.C_b_ind         = C_b_ind;
idx.Profit_FI_ind   = Profit_FI_ind;
idx.RRa_ind         = RRa_ind;
idx.RR_ind          = RR_ind;
idx.I_ind           = I_ind;
idx.x_k_ind         = x_k_ind;
idx.A_g_obs_ind     = A_g_obs_ind;
idx.Y_obs_ind       = Y_obs_ind;
idx.C_obs_ind       = C_obs_ind;
idx.I_obs_ind       = I_obs_ind;
idx.w_obs_ind       = w_obs_ind;
idx.PROFIT_obs_ind  = PROFIT_obs_ind;
idx.unemp_obs_ind   = unemp_obs_ind;
idx.inf_obs_ind     = inf_obs_ind;
idx.R_obs_ind       = R_obs_ind;
idx.pastw_ind       = pastw_ind;
idx.G_obs_ind       = G_obs_ind;
idx.pastYY_ind      = pastYY_ind;
idx.pastCC_ind      = pastCC_ind;
idx.pastII_ind      = pastII_ind;
idx.pastPPROFIT_ind = pastPPROFIT_ind;
idx.pastuu_ind      = pastuu_ind;
idx.pastGG_ind      = pastGG_ind;
idx.pastA_g_ind     = pastA_g_ind;
idx.l_lambda_ind    = l_lambda_ind;
idx.pastQ_ind       = pastQ_ind;
idx.x_I_ind         = x_I_ind; 
idx.eta2_ind        = eta2_ind; 
idx.iota2_ind       = iota2_ind; 
idx.pastLT2_ind     = pastLT2_ind; 
idx.pastG2_ind      = pastG2_ind;
idx.LT_obs_ind      = LT_obs_ind;
idx.B_gov_ncp2_ind  = B_gov_ncp2_ind;

w2_ind            = B_gov_ncp2_ind  + 1;
Profit2_ind       = w2_ind          + 1;
Profit3_ind       = Profit2_ind     + 1;
Profit_FI2_ind    = Profit3_ind     + 1;
r_a2_ind          = Profit_FI2_ind  + 1;

idx.w2_ind          = w2_ind;
idx.Profit2_ind     = Profit2_ind;
idx.Profit3_ind     = Profit3_ind;
idx.Profit_FI2_ind  = Profit_FI2_ind;
idx.r_a2_ind        = r_a2_ind;
